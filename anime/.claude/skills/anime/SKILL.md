---
name: anime
description: 动漫制作项目初始化。用于创建新的动漫项目，设置风格、时长、比例等参数。当用户想要制作动漫、创建动漫视频、生成动画时使用此skill。
license: Complete terms in LICENSE.txt
---

基于oiioii工作流程的自动化动漫制作指南。本 skill 提供完整的动漫制作工作流，从项目初始化到最终视频合成。

## 命令体系

| 命令 | 功能 | 输入 | 输出 |
|------|------|------|------|
| `/anime` | 创建/加载项目 | 主题描述 | 项目配置 |
| `/anime-script` | 生成剧本 | 项目配置 | 故事梗概、角色、分镜概述 |
| `/anime-storyboard` | 生成分镜 | 剧本 | 分镜列表 |
| `/anime-character` | 生成定妆图 | 角色列表 | 角色图像 |
| `/anime-video` | 生成视频 | 分镜+定妆图 | 视频片段 |
| `/anime-merge` | 合成 | 视频+BGM | 最终视频 |

## 工作流程

```
用户输入主题
    │
    ▼
┌─────────────────────────────────────────────────────────────┐
│  /anime "上班族搞笑动漫，30秒"                                │
│  ├─ 选择制作类型：故事短片 / 快速视频 / 音乐短片               │
│  ├─ 选择影片参数：长度、比例、语言                            │
│  ├─ 选择情绪关键词：搞笑/慌乱/反转/尴尬/节奏                   │
│  ├─ 选择视觉风格：147种风格                                   │
│  └─ 输出：项目配置文件                                        │
└─────────────────────────────────────────────────────────────┘
    │
    ▼
┌─────────────────────────────────────────────────────────────┐
│  /anime-script                                               │
│  ├─ 生成故事梗概（起承转合）                                  │
│  ├─ 生成角色列表（名称、外观、性格、服装）                     │
│  ├─ 生成分镜概述                                             │
│  └─ 用户确认/修改                                            │
└─────────────────────────────────────────────────────────────┘
    │
    ▼
┌─────────────────────────────────────────────────────────────┐
│  /anime-storyboard                                           │
│  ├─ 为每个场景生成分镜                                        │
│  │   - 镜号、场景、画面、对白、时长、镜头运动                  │
│  └─ 用户确认/修改                                            │
└─────────────────────────────────────────────────────────────┘
    │
    ▼
┌─────────────────────────────────────────────────────────────┐
│  /anime-character                                            │
│  ├─ 为每个角色生成图像提示词                                  │
│  ├─ 调用 Gemini CLI 生成定妆图                               │
│  └─ 用户确认/重新生成                                        │
└─────────────────────────────────────────────────────────────┘
    │
    ▼
┌─────────────────────────────────────────────────────────────┐
│  /anime-video                                                │
│  ├─ 为每个镜头生成视频提示词                                  │
│  ├─ 调用 Gemini CLI 生成视频片段                             │
│  └─ 用户确认/重新生成                                        │
└─────────────────────────────────────────────────────────────┘
    │
    ▼
┌─────────────────────────────────────────────────────────────┐
│  /anime-merge                                                │
│  ├─ 生成BGM                                                  │
│  ├─ FFmpeg 合成视频片段                                       │
│  ├─ 添加字幕（如有）                                          │
│  └─ 导出最终视频                                             │
└─────────────────────────────────────────────────────────────┘
    │
    ▼
  完成
```

## `/anime` - 项目初始化

**触发词**：`/anime`、`做动漫`、`创建动漫项目`

**用法**：
```
/anime "一个25岁上班族为主角的搞笑动漫，30秒"
```

**执行步骤**：

1. **解析用户输入**
   - 提取主题关键词
   - 识别时长要求
   - 识别风格偏好

2. **引导参数选择**

   | 参数 | 选项 |
   |------|------|
   | 制作类型 | 故事短片 / 快速视频(<15s) / 音乐短片 |
   | 影片长度 | 短视频(<1min) / 长视频(>=1min) |
   | 影片比例 | 横版16:9 / 竖版9:16 |
   | 对白语言 | 中文 / 英文 / 日文 |
   | 情绪关键词 | 搞笑/慌乱/反转/尴尬/节奏/随机 |
   | 视觉风格 | [见风格库] |

3. **创建项目文件**
   - 目录：`~/.claude/skills/anime-generation/projects/{project-name}/`
   - 状态文件：`project.md`

4. **输出项目摘要**
   ```
   项目创建成功！

   名称：上班族搞笑动漫
   类型：故事短片
   时长：30秒
   比例：9:16 竖版
   风格：美式喜剧
   情绪：搞笑、反转

   下一步：执行 /anime-script 生成剧本
   ```

## `/anime-script` - 剧本生成

**触发词**：`/anime-script`、`生成剧本`

**前置条件**：项目已初始化

**输出格式**：

```markdown
## 故事梗概

25岁的上班族阿杰在办公室里展现出惊人的手速和节奏感，
看似在疯狂加班，实则是在电脑上进行一场毫无意义的"敲木鱼"节奏游戏。
就在他获得最高成就时，却发现老板一直站在身后观战，
而老板的反应却出人意料。

## 角色列表

### 阿杰
- **外观**：25岁左右的男性上班族，顶着淡淡的黑眼圈，穿着褶皱的白衬衫
- **性格**：虽然看起来疲惫，但一旦进入状态就会展现出极其夸张的行动力
- **服装**：白色衬衫（微皱）、深色西裤、简单手表、黑皮鞋

### 老板
- **外观**：典型的美式动画风格老板，秃顶，挺着一个巨大的啤酒肚
- **性格**：穿着紧绷的西装背心，平时神情严肃且具有压迫感
- **服装**：灰蓝色西装外套、深灰色西裤、黑皮鞋

## 分镜概述

共6个镜头，30秒时长
- 镜头1-2：建立场景，展现阿杰"疯狂工作"
- 镜头3-4：揭示真相，其实是在玩游戏
- 镜头5：发现老板
- 镜头6：反转结局
```

## `/anime-storyboard` - 分镜生成

**触发词**：`/anime-storyboard`、`生成分镜`

**前置条件**：剧本已完成

**输出格式**：

```markdown
## 分镜列表

| 镜号 | 场景 | 画面描述 | 对白/音效 | 时长 | 镜头 |
|------|------|----------|-----------|------|------|
| 1 | 办公室-全景 | 充满压抑氛围的办公室，阿杰正襟危坐，双手在键盘上化作一团残影 | 键盘敲击声 | 5s | 中景固定 |
| 2 | 办公室-特写 | 特写阿杰湿漉的额头，他的眼神在镜片后飞速转动 | - | 3s | 特写 |
| 3 | 办公室-屏幕 | 阿杰站起身，右手在空中划出一道优美的弧线 | 回车音效 | 3s | 中景→特写 |
| 4 | 办公室-屏幕 | 电脑屏幕特写：屏幕上没有文档，是电子木鱼 | 木鱼敲击声 | 4s | 特写 |
| 5 | 办公室-双人 | 大腹便便的老板正站在阿杰身后 | - | 5s | 中景 |
| 6 | 办公室-结局 | 老板默默掏出手机，露出微笑 | 老板独白 | 10s | 中景→特写 |
```

## `/anime-character` - 定妆图生成

**触发词**：`/anime-character`、`生成定妆图`

**前置条件**：分镜已完成

**提示词模板**：

```
[Style: {风格}], CHARACTER DESIGN SHEET,
{角色名}, {年龄}岁{性别}, {外观描述},
{服装描述}, {特征配饰},
multiple views: front view, side view, 3/4 view,
multiple expressions: neutral, happy, surprised, angry,
white background, full body, high detail,
anime style, clean lines
```

**执行流程**：
1. 生成每个角色的提示词
2. 调用 Gemini CLI 生成图像
3. 保存到 `assets/characters/`
4. 展示结果，用户确认或重新生成

## `/anime-video` - 分镜视频生成

**触发词**：`/anime-video`、`生成视频`

**前置条件**：定妆图已完成

**场景图提示词模板**：

```
[Style: {风格}], anime scene,
{场景类型}: {场景描述},
{角色} {角色动作},
{光线描述}, {氛围},
{镜头角度}: {wide shot / medium shot / close-up},
{色调}
```

**动画提示词模板**：

```
[场景图提示词],
camera motion: {static / pan left / pan right / zoom in / zoom out},
character motion: {动作描述},
duration: {时长}s,
smooth animation, 24fps
```

**执行流程**：
1. 读取分镜列表
2. 为每个镜头生成提示词
3. 调用 Gemini CLI 生成视频
4. 保存到 `assets/videos/`
5. 用户确认或重新生成

## `/anime-merge` - 剪辑合成

**触发词**：`/anime-merge`、`合成视频`

**前置条件**：视频片段已完成

**执行步骤**：

1. **生成BGM**
   ```
   upbeat comedy background music,
   playful rhythm, light percussion,
   office comedy vibe,
   duration: 30s
   ```

2. **FFmpeg 合成**
   ```bash
   # 创建视频列表文件
   echo "file 'shot_01.mp4'" > videos.txt
   echo "file 'shot_02.mp4'" >> videos.txt

   # 合并视频
   ffmpeg -f concat -safe 0 -i videos.txt -c copy merged.mp4

   # 添加背景音乐
   ffmpeg -i merged.mp4 -i bgm.mp3 -c:v copy -c:a aac -shortest final.mp4
   ```

3. **添加字幕**（如有对白）
   ```bash
   ffmpeg -i final.mp4 -vf subtitles=subtitles.srt output.mp4
   ```

4. **导出最终视频**
   - 保存到 `output/`
   - 命名：`{project-name}_final.mp4`

## 风格库（常用风格速查）

| 风格名称 | 英文关键词 | 适用场景 |
|----------|------------|----------|
| 火柴人 | stick figure, simple lines | 简约搞笑 |
| 彩铅素描 | colored pencil sketch | 文艺温馨 |
| 可爱马卡龙 | cute macaron pastel | 萌系可爱 |
| 女频漫画 | shoujo manga style | 浪漫少女 |
| 美式喜剧 | American comedy cartoon | 搞笑夸张 |
| 蜡笔小新 | Crayon Shin-chan style | 童趣搞笑 |
| 日式动漫 | Japanese anime style | 通用动漫 |
| 像素风 | pixel art, 8-bit | 复古游戏 |
| 水彩风 | watercolor painting | 唯美意境 |
| 赛博朋克 | cyberpunk, neon | 科幻未来 |

## 项目状态文件模板

```markdown
# 动漫项目: {项目名}

## 元信息
- 创建时间: YYYY-MM-DD HH:MM
- 当前阶段: init | script | storyboard | character | video | merge | done
- 风格: {风格名称}
- 时长: {秒数}秒
- 比例: {16:9 | 9:16}
- 语言: {中文 | 英文 | 日文}
- 情绪: {情绪关键词}

## 剧本
### 故事梗概
[内容]

### 角色列表
| 角色名 | 外观 | 性格 | 服装 |
|--------|------|------|------|

### 分镜概述
[内容]

## 分镜列表
| 镜号 | 场景 | 画面 | 对白 | 时长 | 镜头 | 状态 |
|------|------|------|------|------|------|------|

## 角色定妆
| 角色名 | 提示词 | 图片路径 | 状态 |
|--------|--------|----------|------|

## 视频片段
| 镜号 | 提示词 | 视频路径 | 状态 |
|------|--------|----------|------|

## 最终输出
- BGM路径:
- 视频路径:
- 导出时间:
```

## 中断恢复机制

### 恢复流程
1. 执行 `/anime` 不带参数
2. 系统列出所有进行中的项目
3. 选择要恢复的项目
4. 自动跳转到当前阶段

### 恢复提示词
```
你有一个进行中的动漫项目：

项目名：上班族搞笑动漫
当前阶段：character（定妆图生成）
进度：角色1/2已完成

执行 /anime-character 继续生成
或执行 /anime "上班族搞笑动漫" 查看项目详情
```

## 质量检查清单

### 剧本检查
- [ ] 故事有起承转合
- [ ] 角色描述足够详细生成图像
- [ ] 分镜数量与时长匹配

### 定妆图检查
- [ ] 风格一致
- [ ] 角色可辨识
- [ ] 包含必要的表情变化

### 视频检查
- [ ] 每个镜头画面清晰
- [ ] 运动流畅
- [ ] 角色造型一致

### 最终输出检查
- [ ] 所有镜头按顺序拼接
- [ ] BGM节奏匹配
- [ ] 字幕清晰可读
- [ ] 导出格式正确

## 经验积累

### 提示词优化
- 风格关键词放在最前面效果最好
- 角色描述要具体到服装配饰
- 动作描述用动词开头

### 已知问题
| 问题 | 解决方案 |
|------|----------|
| 角色在不同镜头不一致 | 在每个提示词中加入定妆图参考 |
| 视频时长不准确 | 明确指定 duration 参数 |
| BGM与画面不匹配 | 先生成视频再根据内容生成BGM |
