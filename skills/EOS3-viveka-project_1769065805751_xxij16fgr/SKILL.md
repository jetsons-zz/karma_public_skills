---
name: train-ticket-expense-organizer
description: "专业的火车票电子客票信息提取与费用报销台账生成工具。自动识别火车票图片中的关键信息(购买方名称、出发日期、出发站点、到达站点、票价、乘车人姓名、开票日期、发票号码),智能分类排序,按月统计报销总额,生成包含明细和汇总两个工作表的Excel费用报销台账。支持批量处理多张电子客票图片。使用触发词「整理火车票」或「生成火车票台账」启动完整处理流程。当用户需要批量处理火车票图片、提取火车票信息、生成报销台账或统计报销金额时激活 当用户需要批量处理火车票图片、提取票据信息、生成报销台账或按月统计报销金额时激活"
license: MIT
compatibility: "支持处理常见格式的火车票电子客票图片(JPG、PNG、PDF等),生成Excel格式(.xlsx)台账文件。需要具备图像识别能力的AI模型支持。适用于企业财务报销、个人差旅费用管理等场景。"
metadata:
  homepage: 
  repository: 
  tags:
    - 火车票
    - 报销
    - 费用管理
    - OCR
    - Excel生成
    - 财务自动化
  language: Python
allowed-tools:
  - Read
  - Write
  - Edit
  - Bash
  - WebFetch
  - Grep
  - Glob
  - Task
---

# 火车票费用报销台账生成器

专业的火车票电子客票信息提取与费用报销台账生成工具。自动识别火车票图片中的关键信息(购买方名称、出发日期、出发站点、到达站点、票价、乘车人姓名、开票日期、发票号码),智能分类排序,按月统计报销总额,生成包含明细和汇总两个工作表的Excel费用报销台账。支持批量处理多张电子客票图片。使用触发词「整理火车票」或「生成火车票台账」启动完整处理流程。当用户需要批量处理火车票图片、提取火车票信息、生成报销台账或统计报销金额时激活

## 使用场景

当用户需要批量处理火车票图片、提取票据信息、生成报销台账或按月统计报销金额时激活

**触发关键词:** 整理火车票, 生成火车票台账, 火车票报销, 电子客票整理, 火车票费用报销台账生成器, 提取火车票信息, 需要火车票费用报销台账生成器, 使用火车票费用报销台账生成器, 运行火车票费用报销台账生成器, 执行火车票费用报销台账生成器

**激活模式:**
- `.*火车票.*台账.*`
- `.*整理.*火车票.*`
- `.*报销.*火车票.*`
- `.*电子客票.*统计.*`

## 使用说明

=== 火车票电子客票信息提取参考文档 ===

[核心功能]
本技能实现火车票电子客票的自动化信息提取和费用报销台账生成,主要包含以下核心模块:

1. 图像识别与信息提取
- 支持识别火车票电子客票中的关键字段
- 提取字段:购买方名称、出发日期、出发站点、到达站点、票价、乘车人姓名、开票日期、发票号码
- 使用多模态AI模型进行OCR识别
- 支持批量处理多张票据图片

2. 数据处理与排序
- 按购买方名称进行分组
- 按出发日期进行时间排序
- 数据清洗和格式标准化
- 异常数据检测与提示

3. 统计分析
- 按月份维度统计报销总额
- 按购买方统计费用汇总
- 生成多维度统计报表

4. Excel台账生成
- 生成包含两个工作表的Excel文件
- 工作表1:明细表 - 包含所有提取的票据详细信息
- 工作表2:汇总表 - 按月份和购买方统计的报销总额
- 自动格式化表格样式(表头加粗、列宽自适应等)

[实现流程]
步骤1:图片收集 - 获取用户上传的所有火车票图片
步骤2:信息提取 - 使用AI模型逐张识别提取关键信息
步骤3:数据整理 - 对提取的数据进行排序和分类
步骤4:统计计算 - 按月份和购买方计算报销总额
步骤5:台账生成 - 创建Excel文件并写入明细和汇总数据
步骤6:结果输出 - 返回生成的台账文件供用户下载

[技术要点]
- 使用openpyxl或xlsxwriter库进行Excel文件操作
- 使用pandas进行数据处理和统计分析
- 使用多模态AI模型(如Claude、GPT-4V等)进行图像识别
- 日期格式统一处理(YYYY-MM-DD)
- 金额格式标准化(保留两位小数)

[输出格式]
明细表列结构:
购买方名称 | 出发日期 | 出发站点 | 到达站点 | 票价(元) | 乘车人姓名 | 开票日期 | 发票号码

汇总表列结构:
月份 | 购买方名称 | 报销总额(元) | 票据数量

## 功能概述

火车票费用报销台账生成器是一个智能化的AI助手技能。专业的火车票电子客票信息提取与费用报销台账生成工具。自动识别火车票图片中的关键信息(购买方名称、出发日期、出发站点、到达站点、票价、乘车人姓名、开票日期、发票号码),智能分类排序,按月统计报销总额,生成包含明细和汇总两个工作表的Excel费用报销台账。支持批量处理多张电子客票图片。使用触发词「整理火车票」或「生成火车票台账」启动完整处理流程。当用户需要批量处理火车票图片、提取火车票信息、生成报销台账或统计报销金额时激活

该技能通过自然语言理解技术，能够准确识别用户意图并提供专业的处理结果。无论是简单的查询还是复杂的分析任务，都能提供高质量的输出。


## 详细使用指南

### 基本用法

1. **激活技能**: 通过相关关键词或直接描述您的需求来激活此技能
2. **提供输入**: 清晰地描述您的任务或问题，提供必要的上下文信息
3. **获取结果**: AI 将处理您的请求并返回详细的结果

### 进阶用法

- 对于复杂任务，可以分步骤描述需求
- 可以指定输出格式和详细程度
- 支持追问和结果优化


## 最佳实践

### 输入建议

- **清晰具体**: 描述需求时尽量清晰具体，避免模糊表述
- **提供上下文**: 包含必要的背景信息，帮助 AI 更好地理解需求
- **明确期望**: 如需特定格式输出，请在请求中说明

### 效率优化

- 一次性提供完整信息可以减少交互次数
- 复杂任务可以拆分为多个小任务
- 善用示例来说明期望的输出格式


## 功能特点

- **智能识别**: 自动识别用户意图，匹配最合适的处理方式
- **灵活适应**: 支持多种输入格式和表述方式
- **专业输出**: 提供结构化、专业化的处理结果
- **持续学习**: 基于用户反馈不断优化表现


## 常见应用场景

### 场景一：快速查询
当您需要快速获取信息或解答疑问时，可以直接向技能提问。

### 场景二：内容处理
当您需要处理、转换或分析内容时，提供原始内容和期望的处理方式。

### 场景三：创意生成
当您需要创意支持或内容创作时，描述您的需求和偏好。


## 注意事项

- 确保输入内容符合技能的处理范围
- 复杂任务可能需要更长的处理时间
- 如结果不满意，可以提供更多细节重新尝试
- 对于敏感信息，请注意隐私保护


## 技术说明

此技能基于先进的自然语言处理技术，结合领域知识库，能够提供专业、准确的处理结果。系统会根据输入内容自动选择最优的处理策略，确保输出质量。

## 示例

### 基础使用

**用户输入:**
```
请使用火车票费用报销台账生成器帮我完成任务
```

**预期输出:**
```
AI 识别到用户需要火车票费用报销台账生成器的功能，激活相应技能并执行任务
```

### 带参数调用

**用户输入:**
```
帮我专业的火车票电子客票信息提取与费用报销台，要求输出详细结果
```

**预期输出:**
```
AI 根据用户的详细要求，提供完整的执行结果和必要的说明
```

### 实际场景应用

**用户输入:**
```
我需要火车票费用报销台账生成器来处理我的工作内容
```

**预期输出:**
```
AI 理解用户的工作场景，提供针对性的解决方案和建议
```

## 资源文件

### 参考文档

- `resources/train-ticket-ocr-guide.md`: 火车票电子客票图像识别和信息提取的技术文档
- `resources/excel-generation-api.md`: 使用Python openpyxl库生成Excel报销台账的API文档
- `resources/data-processing-guide.md`: 使用pandas进行火车票数据排序和统计的技术文档

### 脚本

- `undefined`: 从火车票图片中提取关键信息的Python脚本
- `undefined`: 生成包含明细和汇总的Excel报销台账

### 模板

- `undefined`: 火车票整理完整工作流程模板

## 常见问题

**问: 为什么某些火车票识别不准确?**

答: 可能原因:1)图片模糊或分辨率过低 2)拍照角度倾斜或有反光 3)票面存在手写修改内容 4)图片被裁剪导致信息不完整。建议:重新上传清晰、完整、正面拍摄的票据图片。

**问: 生成的Excel文件打不开怎么办?**

答: 请确认:1)使用Microsoft Excel 2010及以上版本或兼容软件(如WPS) 2)文件下载完整未损坏 3)文件扩展名为.xlsx。如问题持续,请尝试使用其他Excel软件打开或重新生成。

**问: 可以处理多少张火车票?**

答: 理论上无数量限制,但考虑处理效率,建议单次处理不超过50张。大批量票据建议分批处理,如按月份分批。

**问: 汇总表的月份统计依据是什么?**

答: 月份统计基于火车票的'出发日期'字段,而非'开票日期'。这符合差旅费用按实际出行时间归集的财务惯例。

**问: 如何处理同一行程的往返票?**

答: 往返票会作为两条独立记录分别提取(去程和返程),在明细表中分两行展示,在汇总表中分别计入对应月份的报销总额。

**问: 购买方名称为空怎么办?**

答: 如果火车票票面未显示购买方信息,系统会标记为'未识别'或提示用户手动补充。建议保留原始票据以便后续核对。

**问: 能否自定义Excel表格样式?**

答: 当前版本使用标准报销台账格式(蓝色表头、自动列宽)。如需自定义样式,可在生成后使用Excel软件手动调整,或联系开发者定制。

## 调试指南

[调试指南]

问题1:图片识别失败
- 检查图片文件是否可正常打开
- 确认图片格式为支持的类型(JPG/PNG/PDF)
- 查看AI模型API是否正常响应
- 检查图片base64编码是否正确

问题2:数据排序错误
- 验证日期字段格式是否统一(YYYY-MM-DD)
- 检查pandas排序参数配置
- 确认购买方名称字段无异常字符

问题3:Excel生成报错
- 确认openpyxl库已正确安装
- 检查输出路径是否有写入权限
- 验证DataFrame数据结构完整性
- 查看是否有特殊字符导致写入失败

问题4:金额统计不准确
- 检查票价字段是否成功转换为数字类型
- 验证是否存在空值或非法值
- 确认groupby聚合函数配置正确
- 检查是否有重复记录

[日志查看]
- 启用详细日志记录每张票据的处理结果
- 记录识别失败的图片文件名
- 输出中间数据结构便于调试
- 记录Excel生成过程的关键步骤

---

## 元数据

| 字段 | 值 |
|------|----|
| 版本 | 1.0.0 |
| 作者 | Viveka |
| 分类 | 财务管理, 数据处理, 办公自动化 |
| 技能类型 | 数据提取, 文档生成, 图像识别 |

## 更新日志

- **v1.0.0** (2026-01-22): added - 初始版本发布,支持火车票电子客票信息提取、排序、统计和Excel台账生成

